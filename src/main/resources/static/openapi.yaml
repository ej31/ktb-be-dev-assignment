openapi: 3.0.0
info:
  title: ğŸ· Stock ì£¼ì‹ ì •ë³´ ì œê³µ API
  description: íšŒì‚¬ë³„ ì£¼ì‹ ì¢…ë£Œê°€ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” API
  version: "1.0.0"
  contact:
    email: yulim38392@naver.com
  license:
    name: Apache 2.0
    url: "http://www.apache.org/licenses/LICENSE-2.0.html"

servers:
  - url: https://virtserver.swaggerhub.com/spring-1d3/stockapi/1.0.0
    description: SwaggerHub API Auto Mocking
  - url: http://localhost:8080
    description: Local Development Server

tags:
  - name: developers
    description: ì£¼ì‹ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” API

paths:
  /api/v1/stock/history:
    get:
      tags:
        - developers
      summary: íŠ¹ì • ê¸°ì—…ì˜ ì£¼ì‹ ì¢…ê°€ ì¡°íšŒ
      operationId: getStockHistory
      description: |
        íŠ¹ì • ê¸°ì—…ì˜ ì£¼ì‹ ì¢…ê°€ ë°ì´í„°ë¥¼ ê¸°ê°„ë³„ë¡œ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      parameters:
        - in: query
          name: company_code
          description: ê¸°ì—…ì˜ ì¢…ëª© ì½”ë“œ
          required: true
          schema:
            type: string
            example: "ACM"
        - in: query
          name: start_date
          description: |
            ì¡°íšŒ ì‹œì‘ ë‚ ì§œ (í˜•ì‹: YYYY-MM-DD)
            - í•„ìˆ˜ ê°’ì…ë‹ˆë‹¤.
            - ì˜¬ë°”ë¥¸ í˜•ì‹ì´ ì•„ë‹ ê²½ìš° `INVALID_DATE_FORMAT` ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
          required: true
          schema:
            type: string
            format: date
            example: "2025-01-01"
        - in: query
          name: end_date
          description: |
            ì¡°íšŒ ì¢…ë£Œ ë‚ ì§œ (í˜•ì‹: YYYY-MM-DD)
            - í•„ìˆ˜ ê°’ì…ë‹ˆë‹¤.
            - ì˜¬ë°”ë¥¸ í˜•ì‹ì´ ì•„ë‹ ê²½ìš° `INVALID_DATE_FORMAT` ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
          required: true
          schema:
            type: string
            format: date
            example: "2025-02-01"
        - in: header
          name: x-api-key
          description: API í‚¤ (í•„ìˆ˜)
          required: true
          schema:
            type: string
            example: "c18aa07f-f005-4c2f-b6db-dff8294e6b5e"
      responses:
        "200":
          description: ìš”ì²­í•œ ì¢…ëª©ì˜ ì£¼ì‹ ì¢…ê°€ ë°ì´í„° ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/StockHistory"

        "400":
          description: ìš”ì²­ íŒŒë¼ë¯¸í„° ëˆ„ë½ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•Šì€ ê°’
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                missingCompanyCode:
                  summary: company_code ëˆ„ë½
                  value:
                    errorCode: 400
                    message: "MISSING_COMPANY_CODE"
                missingStartDate:
                  summary: start_date ëˆ„ë½
                  value:
                    errorCode: 400
                    message: "MISSING_START_DATE"
                missingEndDate:
                  summary: end_date ëˆ„ë½
                  value:
                    errorCode: 400
                    message: "MISSING_END_DATE"
                invalidStartDateFormat:
                  summary: ì˜ëª»ëœ `start_date` í˜•ì‹
                  value:
                    errorCode: 400
                    message: "INVALID_START_DATE_FORMAT"
                invalidEndDateFormat:
                  summary: ì˜ëª»ëœ `end_date` í˜•ì‹
                  value:
                    errorCode: 400
                    message: "INVALID_END_DATE_FORMAT"

        "403":
          description: API Key ì¸ì¦ ì‹¤íŒ¨
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                missingApiKey:
                  summary: API Key ì—†ìŒ
                  value:
                    errorCode: 403
                    message: "MISSING_API_KEY"
                invalidApiKey:
                  summary: API Key ì¸ì¦ ì‹¤íŒ¨
                  value:
                    errorCode: 403
                    message: "INVALID_API_KEY"

        "404":
          description: ê¸°ì—… ì½”ë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                companyNotFound:
                  summary: ê¸°ì—… ì½”ë“œ ì—†ìŒ
                  value:
                    errorCode: 404
                    message: "COMPANY_NOT_FOUND"

        "500":
          description: ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                internalServerError:
                  summary: ì„œë²„ ì˜¤ë¥˜
                  value:
                    errorCode: 500
                    message: "INTERNAL_SERVER_ERROR"

components:
  schemas:
    StockHistory:
      type: object
      required:
        - companyName
        - tradeDate
        - closingPrice
      properties:
        companyName:
          type: string
          description: ê¸°ì—…ëª…
          example: "ì‚¼ì„±ì „ì"
        tradeDate:
          type: string
          format: date
          description: ì£¼ì‹ ê±°ë˜ ë‚ ì§œ
          example: "2025-01-02"
        closingPrice:
          type: number
          format: float
          description: ì¢…ê°€ (Close Price)
          example: 71500.0

    ErrorResponse:
      type: object
      properties:
        errorCode:
          type: integer
          description: ì˜¤ë¥˜ ì½”ë“œ (400ìœ¼ë¡œ ê³ ì •)
          example: 400
        message:
          type: string
          description: ì˜¤ë¥˜ ë©”ì‹œì§€ ì½”ë“œ (í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë§¤ì¹­í•˜ì—¬ ì²˜ë¦¬)
          example: "MISSING_PARAMETER"
